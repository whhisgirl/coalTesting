<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.CoalListMapper">

    <resultMap type="CoalList" id="CoalListResult">
        <result property="coalNumber"    column="coal_number"    />
        <result property="sampleTime"    column="sample_time"    />
        <result property="standardNumber"    column="standard_number"    />
        <result property="sampleStrength"    column="sample_strength"    />
        <result property="samplingMethod"    column="sampling_method"    />
        <result property="miningAreaName"    column="mining_area_name"    />
        <result property="sampler"    column="sampler"    />
        <result property="batchCoalWeight"    column="batch_coal_weight"    />
        <result property="locationMiningArea"    column="location_mining_area"    />
    </resultMap>

    <sql id="selectCoalListVo">
        select coal_registration.coal_number, batch.coal_number, coal_registration.sample_time, coal_registration.standard_number, coal_registration.sample_strength, coal_registration.sampling_method, coal_registration.mining_area_name, coal_registration.sampler, batch.batch_coal_weight, batch.location_mining_area from coal_registration INNER JOIN batch ON coal_registration.coal_number=batch.coal_number
    </sql>


    <select id="selectCoalList" parameterType="CoalList" resultMap="CoalListResult">
        <include refid="selectCoalListVo"/>
        <where>
            <if test="sampleTime != null "> and sample_time = #{sampleTime}</if>
            <if test="standardNumber != null  and standardNumber != ''"> and standard_number = #{standardNumber}</if>
            <if test="sampleStrength != null  and sampleStrength != ''"> and sample_strength = #{sampleStrength}</if>
            <if test="samplingMethod != null  and samplingMethod != ''"> and sampling_method = #{samplingMethod}</if>
            <if test="miningAreaName != null  and miningAreaName != ''"> and mining_area_name like concat('%', #{miningAreaName}, '%')</if>
            <if test="sampler != null  and sampler != ''"> and sampler = #{sampler}</if>
            <if test="batchCoalWeight != null  and batchCoalWeight != ''"> and batch_coal_weight = #{batchCoalWeight}</if>
            <if test="locationMiningArea != null  and locationMiningArea != ''"> and location_mining_area = #{locationMiningArea}</if>
        </where>
    </select>

    <select id="selectCoalListByCoalNumber" parameterType="String" resultMap="CoalListResult">
        <include refid="selectCoalListVo"/>
        where coal_number = #{coalNumber}
    </select>
</mapper>
